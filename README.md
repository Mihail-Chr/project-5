# project-5
сборный проект 5 (пдбор изображения по коментарию)
Данные доступны по [ссылке](https://code.s3.yandex.net/datasets/dsplus_integrated_project_4.zip).

В файле `train_dataset.csv` находится информация, необходимая для обучения: имя файла изображения, идентификатор описания и текст описания. Для одной картинки может быть доступно до 5 описаний. Идентификатор описания имеет формат `<имя файла изображения>#<порядковый номер описания>`.

В папке `train_images` содержатся изображения для тренировки модели.

В файле `CrowdAnnotations.tsv` — данные по соответствию изображения и описания, полученные с помощью краудсорсинга. Номера колонок и соответствующий тип данных:

1. Имя файла изображения.
2. Идентификатор описания.
3. Доля людей, подтвердивших, что описание соответствует изображению.
4. Количество человек, подтвердивших, что описание соответствует изображению.
5. Количество человек, подтвердивших, что описание не соответствует изображению.

В файле `ExpertAnnotations.tsv` содержатся данные по соответствию изображения и описания, полученные в результате опроса экспертов. Номера колонок и соответствующий тип данных:

1. Имя файла изображения.
2. Идентификатор описания.

3, 4, 5 — оценки трёх экспертов.

Эксперты ставят оценки по шкале от 1 до 4, где 1 — изображение и запрос совершенно не соответствуют друг другу, 2 — запрос содержит элементы описания изображения, но в целом запрос тексту не соответствует, 3 — запрос и текст соответствуют с точностью до некоторых деталей, 4 — запрос и текст соответствуют полностью.

В файле `test_queries.csv` находится информация, необходимая для тестирования: идентификатор запроса, текст запроса и релевантное изображение. Для одной картинки может быть доступно до 5 описаний. Идентификатор описания имеет формат `<имя файла изображения>#<порядковый номер описания>`.

В папке `test_images` содержатся изображения для тестирования модели.

В некоторых странах, где работает ваша компания, действуют ограничения по обработке изображений: поисковым сервисам и сервисам, предоставляющим возможность поиска, запрещено без разрешения родителей или законных представителей предоставлять любую информацию, в том числе, но не исключительно тексты, изображения, видео и аудио, содержащие описание, изображение или запись голоса детей. Ребёнком считается любой человек, не достигший 16 лет.

В вашем сервисе строго следуют законам стран, в которых работают. Поэтому при попытке посмотреть изображения, запрещённые законодательством, вместо картинок показывается дисклеймер:

> This image is unavailable in your country in compliance with local laws
>

Однако у вас в PoC нет возможности воспользоваться данным функционалом. Поэтому все изображения, которые нарушают данный закон, нужно удалить из обучающей выборки.

Наш датасет содержит экспертные и краудсорсинговые оценки соответствия текста и изображения.

В файле с экспертными мнениями для каждой пары изображение-текст имеются оценки от трёх специалистов. Для решения задачи вы должны эти оценки агрегировать — превратить в одну. Существует несколько способов агрегации оценок, самый простой — голосование большинства: за какую оценку проголосовала большая часть экспертов (в нашем случае 2 или 3), та оценка и ставится как итоговая. Поскольку число экспертов меньше числа классов, может случиться, что каждый эксперт поставит разные оценки, например: 1, 4, 2. В таком случае данную пару изображение-текст можно исключить из датасета.

Вы можете воспользоваться другим методом агрегации оценок или придумать свой.

В файле с краудсорсинговыми оценками информация расположена в таком порядке:

1. Доля исполнителей, подтвердивших, что текст **соответствует** картинке.
2. Количество исполнителей, подтвердивших, что текст **соответствует** картинке.
3. Количество исполнителей, подтвердивших, что текст **не соответствует** картинке.



Модель возвращает на выходе вероятность соответствия изображения тексту, поэтому целевая переменная имеет значения от 0 до 1.

### Выводы анализа данных и проверки
в ходе предподготовки данных было выявленно следующее:
 - после "отчистки" данных от stop слов , связанных с детьми - осталось 1400 записей.
 - в фаилах оценки от крауда присутствуют query_id (23 элемента) для которых нет текстового описания в фаиле Train
 - пары "query_id" и "image" в фаиле от крауда не совпадают ни с экспертными данными, ни с фаилом train / Скорее всего это системная ошибка : либо при постановке задачи, либо при при записи результата. Даные не являются полными, поэтому данными из этого фаила решено не использовать
 - при разметке целевой переменной принято решение, что оценку принять средней и нормализировать относительно максимума (4)
 - на оставшихся картинках среди "правильно размеченных" больше всего "белых мужчин с собакой бугущих к черной женщине, а люди прыгают, стоя в воде, и идет коричневый снег.." :)- наиболее чаще всего встречающиеся слова в описании 
 - для уменьшения вычислительной нагрузки принято решение векторизировать уникальные значения после лемманизации

### Оценка размерности векторов
 - размерность вектора описания составляет 800/768 (ограничена пользователем/моделью BERT)
 - размерность вектора изображения - 1000
 - "баланс" классов соблюден

### выбор метрики
 - будет проведена кросс валидация по основным моделям регресси с учетов вариативности во разным методам веторизации запросов
 - в качестве метрики оценки моделей была выбран метрика mean_absolute_error - которая показывает, среднюю абсолютную ошибку регрессии. К тому же она устойчива к выбросам..

   
